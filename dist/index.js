"use strict";exports.__esModule=!0,exports.createAnyState=void 0;var Immutable=function(t){return JSON.parse(JSON.stringify(t))},getPaths=(Immutable.getIn=function(t,e){var n=t;return e.forEach(function(t){void 0!==n&&(n=n[t])}),n},Immutable.setIn=function(t,n,e){var r=t,a=e;return"object"==typeof e&&(a=Immutable(e)),n.forEach(function(t,e){void 0!==r&&(e===n.length-1?r[t]=a:r=r[t])}),t},Immutable.asMutable=function(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t},function(t){return t.split(/\[|\]|\./g).reduce(function(t,e){return""!==e&&null!=e&&(/^\d+$/.test(e)?t.push(parseInt(e,10)):t.push(e)),t},[])}),getIdPath=function(t){return t.join("/")},AnyState=function(){var i=null,u=[];return{setState:function(e){i=Immutable(e),u.forEach(function(t){return t.callback(i,e)})},setItem:function(r,t){var a,e=[],o=Immutable(i);if(!Array.isArray(r)&&"string"!=typeof r&&"number"!=typeof r)throw new Error("setItem: key must be a string or an array of strings");if(!i)throw new Error("State is not initialized");"string"==typeof r?e=getPaths(r):"number"==typeof r?e=[r]:Array.isArray(r)&&(e=r),a=getIdPath(e),void 0===Immutable.getIn(i,e)&&console.warn("Trying to set item ".concat(r," but it doesn't exist")),i=Immutable.setIn(i,e,t),u.forEach(function(t){var e,n;t&&0===t.key.indexOf(a)&&(typeof(e=Immutable.getIn(o,t.paths))!=typeof(n=Immutable.getIn(i,t.paths))&&console.warn("Type mismatch for ".concat(r)),t.callback(n,e))})},getState:function(){return Immutable.asMutable(i)},getItem:function(t){var e=t;if(Array.isArray(t)||"string"==typeof t||"number"==typeof t)return"string"==typeof t&&(e=getPaths(t)),t=Immutable.getIn(i,e),Immutable.asMutable(t);throw new Error("setItem: key must be a string or an array of strings")},watch:function(t,e){if(!i)throw new Error("State is not initialized");if("function"!=typeof e)throw new Error("callback must be a function");var n=getPaths(t),t=(void 0===Immutable.getIn(i,n)&&console.warn("Trying to watch item ".concat(t," but it doesn't exist")),getIdPath(n));u.push({key:t,callback:e,paths:n})}}},createAnyState=function(t){var t=Immutable(t),e=AnyState();return e.setState(t),e};exports.createAnyState=createAnyState;